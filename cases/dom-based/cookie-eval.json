{
  "title": "Cookie via eval",
  "description": "Executes JavaScript pulled directly from a cookie value, keeping the sink hidden from the URL.",
  "objectives": [
    "Find where the q cookie is read before eval executes.",
    "Set the q cookie manually and trigger script execution.",
    "Trace how document.cookie becomes the data source for the sink."
  ],
  "hints": [
    "Nothing in the URL sets the value; inspect the JavaScript.",
    "The helper function searches for a specific cookie key.",
    "Set it from DevTools: document.cookie='q=<payload>'"
  ],
  "difficulty": "medium",
  "category": "dom-based",
  "risk": "high",
  "status": "active",
  "type": "html",
  "body": "<h3>Session Restorer</h3><p>This page attempts to restore your session from a cookie. If no cookie is found, it logs 'Guest Mode' to the console.</p><script>function getCookie(name){return document.cookie.split('; ').find(row=>row.startsWith(name+'='))?.split('=')[1];}const token=getCookie('q');if(token){eval(token);}else{console.log('Guest Mode Active - No token found');}</script>"
}
