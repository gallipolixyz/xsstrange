{
    "title": "Javascript Unquoted Assignment",
    "description": "Assigns the parameter value to an unquoted js assignment, i.e. var foo = %q;",
    "category": "dom-based",
    "difficulty": "Medium",
    "risk": "High",
    "status": "Active",
    "type": "js-unquoted",

    "body": "<h3>JavaScript Injection (Unquoted Assignment)</h3>\n<p>The user input is placed inside a `<script>` block as an unquoted variable assignment.</p>\n<p>Param: <code>?q=</code></p>\n\n<script>\n    var username = 'Guest';\n    var userID = 101;\n\n    // INJECTION POINT:\n    var data = {{ request.args.get('q', 'default_value') | safe }};\n\n    console.log('Data loaded for user:', data);\n</script>\n\n<p>Check the browser's console to observe the executed JavaScript code.</p>",

    "objectives": [
        "Escape the assignment context using a semicolon (`;`).",
        "Inject a command to execute arbitrary JavaScript (e.g., `alert(1)`).",
        "Observe the successful execution of the injected code (e.g., an alert box appearing)."
    ],

    "hints": [
        "The context is: `var data = [INPUT];`",
        "You must terminate the line before injecting new code.",
        "Try a payload like: `100; alert(1)`"
    ]
}