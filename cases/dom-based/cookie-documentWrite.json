{
  "title": "Cookie via document.write",
  "description": "DOM-based XSS that pulls a value from a cookie and feeds it directly into document.write().",
  "objectives": [
    "Read the code path that extracts the q cookie value.",
    "Confirm document.write() renders and executes the cookie content as HTML.",
    "Clear or overwrite the cookie to observe persistence and re-exploitation."
  ],
  "hints": [
    "No URL params hereâ€”set the cookie manually: document.cookie='q=<payload>'.",
    "document.write() is the sink; whatever is in q becomes HTML.",
    "If your payload persists across refresh, delete the q cookie."
  ],
  "difficulty": "low",
  "category": "dom-based",
  "risk": "critical",
  "status": "active",
  "type": "html",
  "body": "<h3>Cookie -> document.write() sink</h3><p>Set a cookie named <b>q</b> to control the output.</p><div id='result'></div><script>const match=document.cookie.match(/(^| )q=([^;]+)/);if(match){const payload=decodeURIComponent(match[2]);document.write('<b>Stored Cookie Value:</b> '+payload);}</script>"
}
