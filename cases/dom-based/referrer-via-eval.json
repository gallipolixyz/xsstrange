{
  "title": "Referrer via eval",
  "description": "This test demonstrates a DOM-based XSS vulnerability where the application extracts parameters from document.referrer and passes attacker-controlled data directly into eval(). No document.write() is used, making the vulnerability harder to spot in code reviews.",
  "objectives": [
    "Understand how the Referrer header becomes attacker-controlled.",
    "Identify the unsafe sink: eval().",
    "Recognize the danger of parsing untrusted URLs inside JavaScript.",
    "Exploit the vulnerability using an iframe to spoof the Referrer."
  ],
  "hints": [
    "To get a non-empty referrer, first visit a payload URL and then navigate to this case in the same tab; opening this page directly leaves document.referrer empty.",
    "Example step 1: Go to http://example-page.com/cases/reflected/php-search-form/?q=alert('referrer')",
    "Example step 2: In the console run window.location='http://your-xsstrange.app/cases/dom-based/referrer-via-eval/' or click a link; the referrer string gets decoded and executed via eval, triggering XSS."
    ],
  "difficulty": "medium",
  "category": "referrer-xss",
  "risk": "low",
  "type": "html",
  "status": "active",
  "body": "<script> const ref=document.referrer; try { if(ref){ const url=new URL(ref); for(const val of url.searchParams.values()){ const decoded=decodeURIComponent(val); eval(decoded); } } } catch(err){ console.warn('Referrer parsing failed:', err); }</script>"
}
