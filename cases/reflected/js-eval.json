{
    "title": "PHP JavaScript Eval",
    "description": "Takes the q parameter in PHP and injects it directly into a JavaScript eval() call.",
    "category": "reflected",
    "difficulty": "Medium",
    "risk": "High",
    "status": "Active",
    "type": "php",

    "php": "<?php\n$payload = isset($_GET['q']) ? $_GET['q'] : \"console.log('default eval payload')\";\n?>\n<!DOCTYPE html>\n<html>\n<body>\n    <h3>PHP to JavaScript eval()</h3>\n    <p>The <code>q</code> parameter is inserted directly into an <code>eval()</code> call.</p>\n    <p>Param: <code>?q=</code></p>\n\n    <script>\n        // INJECTION POINT: entire eval argument is attacker-controlled\n        eval(<?php echo $payload; ?>);\n    </script>\n\n    <p>Whatever you place in <code>q</code> is executed inside <code>eval()</code>.</p>\n</body>\n</html>",

    "objectives": [
        "Provide JavaScript in <code>q</code> that executes immediately (e.g., <code>alert(1)</code>).",
        "Observe that the payload runs because it is executed via <code>eval()</code>.",
        "Note that PHP reflection happens before the browser executes the script."
    ],

    "hints": [
        "The context is: <code>eval([INPUT]);</code> generated by PHP.",
        "No quotes are added around your input; send runnable JavaScript directly.",
        "A simple payload such as <code>alert(1)</code> should fire without extra escaping."
    ]
}
